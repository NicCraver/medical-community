(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bb38face"],{"13d5":function(t,e,a){"use strict";var r=a("23e7"),i=a("d58f").left,s=a("a640"),l=a("2d00"),n=a("605d"),o=!n&&l>79&&l<83,c=o||!s("reduce");r({target:"Array",proto:!0,forced:c},{reduce:function(t){var e=arguments.length;return i(this,t,e,e>1?arguments[1]:void 0)}})},"3add":function(t,e,a){},4362:function(t,e,a){e.nextTick=function(t){var e=Array.prototype.slice.call(arguments);e.shift(),setTimeout((function(){t.apply(null,e)}),0)},e.platform=e.arch=e.execPath=e.title="browser",e.pid=1,e.browser=!0,e.env={},e.argv=[],e.binding=function(t){throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";e.cwd=function(){return r},e.chdir=function(e){t||(t=a("df7c")),r=t.resolve(e,r)}}(),e.exit=e.kill=e.umask=e.dlopen=e.uptime=e.memoryUsage=e.uvCounters=function(){},e.features={}},"4e26":function(t,e,a){"use strict";a("3add")},"605d":function(t,e,a){(function(e){var r=a("c6b6");t.exports="undefined"!=typeof e&&"process"==r(e)}).call(this,a("4362"))},a640:function(t,e,a){"use strict";var r=a("d039");t.exports=function(t,e){var a=[][t];return!!a&&r((function(){a.call(null,e||function(){return 1},1)}))}},bd58:function(t,e,a){},d58f:function(t,e,a){var r=a("59ed"),i=a("7b0b"),s=a("44ad"),l=a("07fa"),n=TypeError,o=function(t){return function(e,a,o,c){r(a);var u=i(e),d=s(u),p=l(u),h=t?p-1:0,g=t?-1:1;if(o<2)while(1){if(h in d){c=d[h],h+=g;break}if(h+=g,t?h<0:p<=h)throw n("Reduce of empty array with no initial value")}for(;t?h>=0:p>h;h+=g)h in d&&(c=a(c,d[h],h,u));return c}};t.exports={left:o(!1),right:o(!0)}},df7c:function(t,e,a){(function(t){function a(t,e){for(var a=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),a++):a&&(t.splice(r,1),a--)}if(e)for(;a--;a)t.unshift("..");return t}function r(t){"string"!==typeof t&&(t+="");var e,a=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){a=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(a,r)}function i(t,e){if(t.filter)return t.filter(e);for(var a=[],r=0;r<t.length;r++)e(t[r],r,t)&&a.push(t[r]);return a}e.resolve=function(){for(var e="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var l=s>=0?arguments[s]:t.cwd();if("string"!==typeof l)throw new TypeError("Arguments to path.resolve must be strings");l&&(e=l+"/"+e,r="/"===l.charAt(0))}return e=a(i(e.split("/"),(function(t){return!!t})),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),l="/"===s(t,-1);return t=a(i(t.split("/"),(function(t){return!!t})),!r).join("/"),t||r||(t="."),t&&l&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,(function(t,e){if("string"!==typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,a){function r(t){for(var e=0;e<t.length;e++)if(""!==t[e])break;for(var a=t.length-1;a>=0;a--)if(""!==t[a])break;return e>a?[]:t.slice(e,a-e+1)}t=e.resolve(t).substr(1),a=e.resolve(a).substr(1);for(var i=r(t.split("/")),s=r(a.split("/")),l=Math.min(i.length,s.length),n=l,o=0;o<l;o++)if(i[o]!==s[o]){n=o;break}var c=[];for(o=n;o<i.length;o++)c.push("..");return c=c.concat(s.slice(n)),c.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!==typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),a=47===e,r=-1,i=!0,s=t.length-1;s>=1;--s)if(e=t.charCodeAt(s),47===e){if(!i){r=s;break}}else i=!1;return-1===r?a?"/":".":a&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var a=r(t);return e&&a.substr(-1*e.length)===e&&(a=a.substr(0,a.length-e.length)),a},e.extname=function(t){"string"!==typeof t&&(t+="");for(var e=-1,a=0,r=-1,i=!0,s=0,l=t.length-1;l>=0;--l){var n=t.charCodeAt(l);if(47!==n)-1===r&&(i=!1,r=l+1),46===n?-1===e?e=l:1!==s&&(s=1):-1!==e&&(s=-1);else if(!i){a=l+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===a+1?"":t.slice(e,r)};var s="b"==="ab".substr(-1)?function(t,e,a){return t.substr(e,a)}:function(t,e,a){return e<0&&(e=t.length+e),t.substr(e,a)}}).call(this,a("4362"))},e3db:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"DiseaseTag"},[e("ProLayout",{attrs:{mainBgColor:"#F5F5F5",padding:"0"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("病种标签")]},proxy:!0},{key:"main",fn:function(){return[e("ProList",{staticClass:"ProList",attrs:{pageParams:t.pageParams,total:t.total,onInquire:t.onInquire},scopedSlots:t._u([{key:"header",fn:function(){return[e("el-input",{attrs:{placeholder:"展示名称/标签名称",clearable:""},model:{value:t.queryParams.tagDesc,callback:function(e){t.$set(t.queryParams,"tagDesc",e)},expression:"queryParams.tagDesc"}}),e("el-select",{attrs:{placeholder:"状态",clearable:"",filterable:""},model:{value:t.queryParams.status,callback:function(e){t.$set(t.queryParams,"status",e)},expression:"queryParams.status"}},t._l(t.statusList,(function(t,a){return e("el-option",{key:a,attrs:{label:t.label,value:t.value}})})),1),e("el-cascader",{attrs:{options:t.queryDeptData,placeholder:"科室名称",clearable:""},model:{value:t.queryParams.deptId,callback:function(e){t.$set(t.queryParams,"deptId",e)},expression:"queryParams.deptId"}}),e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","start-placeholder":"创建开始日期","end-placeholder":"创建结束日期","range-separator":"至",clearable:""},model:{value:t.addDate,callback:function(e){t.addDate=e},expression:"addDate"}})]},proxy:!0},{key:"actions",fn:function(){return[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onInquire()}}},[t._v("搜索")]),e("el-button",{on:{click:t.resetQueryParams}},[t._v("重置")])]},proxy:!0},{key:"batchActions",fn:function(){return[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showTagDetail("add")}}},[t._v("新增")]),e("el-button",{on:{click:t.batchStart}},[t._v("批量开启")]),0!==t.multipleSelection.length?e("div",{staticClass:"alert"},[e("IconSvg",{staticStyle:{margin:"0 5px 0 5px"},attrs:{iconClass:"prompt",width:"18"}}),e("div",{staticStyle:{margin:"0 5px 0 5px"}},[t._v("已选择 "+t._s(t.multipleSelection.length)+"项")]),e("el-button",{staticStyle:{margin:"0 5px 0 5px"},attrs:{type:"text"},on:{click:t.clearFun}},[t._v(" 清空 ")])],1):t._e()]},proxy:!0}])},[e("el-table",{directives:[{name:"adaptive",rawName:"v-adaptive",value:{bottomOffset:60},expression:"{ bottomOffset: 60 }"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"singleTable",attrs:{height:"100px","row-key":"id",data:t.tableData,border:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"40","reserve-selection":!0,selectable:t=>1===t.status}}),e("el-table-column",{attrs:{label:"序号",type:"seq",width:"50"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.seq))])]}}])}),e("el-table-column",{attrs:{label:"展示名称",prop:"tagShowDesc"}}),e("el-table-column",{attrs:{label:"标签名称",prop:"tagDesc"}}),e("el-table-column",{attrs:{label:"所属科室",prop:"allDeptName"}}),e("el-table-column",{attrs:{label:"创建人",prop:"createUserName"}}),e("el-table-column",{attrs:{label:"创建时间",prop:"createDate","min-width":"120"}}),e("el-table-column",{attrs:{label:"更新时间",prop:"modDate","min-width":"120"}}),e("el-table-column",{attrs:{label:"更新人",prop:"modUserName"}}),e("el-table-column",{attrs:{label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-switch",{attrs:{value:a.status,"active-value":0,"inactive-value":1},nativeOn:{click:function(e){return t.handleSwitchChange(a)}}}),e("span",{class:["status",0===a.status?"active":"inactive"]},[t._v(t._s(0===a.status?"开启":"关闭"))])]}}])}),e("el-table-column",{attrs:{label:"操作",fixed:"right",width:"220"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showTagDetail("check",a)}}},[t._v("查看")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showTagDetail("edit",a)}}},[t._v("编辑")])]}}])})],1)],1)]},proxy:!0}])}),e("ProDrawer",{staticClass:"tag-drawer",attrs:{visible:t.drawerVisible,title:"新增",direction:"rtl",size:600,"show-close":""},on:{"update:visible":function(e){t.drawerVisible=e}}},[e("div",{staticClass:"title"},[t._v("标签信息")]),e("TagDetailForm",{ref:"drawerTagDetail",attrs:{mode:t.tagDetailMode,tagDetail:t.tagDetail}}),e("template",{slot:"footer"},[e("el-button",{attrs:{type:"default"},on:{click:function(e){t.drawerVisible=!1}}},[t._v("返回")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmitTagDetail("drawerTagDetail")}}},[t._v("保存")])],1)],2),e("ProDialog",{attrs:{visible:t.dialogVisible,title:"edit"===t.tagDetailMode?"编辑":"查看",width:"700px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmitTagDetail("dialogTagDetail")}}},[t._v(" 确 定 ")])]},proxy:!0}])},[e("TagDetailForm",{ref:"dialogTagDetail",attrs:{mode:t.tagDetailMode,tagDetail:t.tagDetail}})],1)],1)},i=[],s=(a("14d9"),a("13d5"),a("a211")),l=function(){var t=this,e=t._self._c;return e("el-form",{ref:"elForm",staticClass:"tag-form",attrs:{disabled:"check"===t.mode,"label-width":"100px",model:t.tagDetail,rules:t.rules}},[e("el-form-item",{attrs:{label:"展示名称",prop:"tagShowDesc"}},[e("el-input",{attrs:{placeholder:"展示名20个字符以内",maxlength:"20"},model:{value:t.tagDetail.tagShowDesc,callback:function(e){t.$set(t.tagDetail,"tagShowDesc",e)},expression:"tagDetail.tagShowDesc"}}),e("div",{staticClass:"tips"},[t._v("不超过20个字符，可输入中英文、数字，无符号限制。")])],1),e("el-form-item",{attrs:{label:"标签名称",prop:"tagDesc"}},[e("el-input",{attrs:{placeholder:"请输入内容",disabled:"add"!==t.mode,maxlength:"20"},model:{value:t.tagDetail.tagDesc,callback:function(e){t.$set(t.tagDetail,"tagDesc",e)},expression:"tagDetail.tagDesc"}},[e("template",{slot:"prepend"},[t._v("Tag")])],2),"add"!==t.mode?e("el-switch",{staticClass:"abs-switch",attrs:{"active-value":0,"inactive-value":1},model:{value:t.tagDetail.status,callback:function(e){t.$set(t.tagDetail,"status",e)},expression:"tagDetail.status"}}):t._e(),e("div",{staticClass:"tips"},[t._v("不超过20个字符。创建后，标签名称不可修改。")])],1),e("el-form-item",{attrs:{label:"标签描述"}},[e("el-input",{attrs:{placeholder:"请输入标签描述，最多20个字符",maxlength:"20"},model:{value:t.tagDetail.description,callback:function(e){t.$set(t.tagDetail,"description",e)},expression:"tagDetail.description"}})],1),e("el-form-item",{attrs:{label:"所属科室",prop:"deptId"}},[e("el-cascader",{attrs:{filterable:"",options:t.deptData,placeholder:"科室名称"},model:{value:t.tagDetail.deptId,callback:function(e){t.$set(t.tagDetail,"deptId",e)},expression:"tagDetail.deptId"}})],1),"add"===t.mode?e("el-form-item",{attrs:{label:"标签状态"}},[e("el-switch",{attrs:{"active-value":0,"inactive-value":1},model:{value:t.tagDetail.status,callback:function(e){t.$set(t.tagDetail,"status",e)},expression:"tagDetail.status"}})],1):t._e()],1)},n=[],o=a("365c");const c=t=>o["a"].post({url:"/ygt-user/tbTagDiseaseDept/onQueryTagDiseaseDept",data:t}),u=t=>o["a"].get({url:"/ygt-user/tbDictionaryDetail/getDeptDictionaryForTagDisease",params:t}),d=t=>o["a"].post({url:"/ygt-user/tbTagDiseaseDept/onSaveTagDiseaseDept",data:t}),p=t=>o["a"].post({url:"/ygt-richdiseases/tbMbPatientRichDisease/checkTagUseStatus",data:t}),h=t=>o["a"].post({url:"/ygt-user/tbTagDiseaseDept/changeStatus",data:t}),g=t=>o["a"].get({url:"/ygt-user/tbTagDiseaseDept/getDeptDictionaryForQuery",params:t});var f={props:["mode","tagDetail"],data(){return{rules:{tagShowDesc:[{required:!0,message:"请输入展示名称",trigger:"blur"}],tagDesc:[{required:!0,message:"请输入标签名称",trigger:"blur"}],deptId:[{required:!0,message:"请选择所属科室",trigger:"blur"}]},deptData:[]}},mounted(){this.getTagDiseaseDepts()},methods:{async getTagDiseaseDepts(){try{const t=await u(),e=t.result;this.filterDeptData(e),this.deptData=e}catch(t){}},filterDeptData(t){t.forEach(t=>{t.children.length?this.filterDeptData(t.children):t.children=null})},validate(t){this.$refs.elForm.validate(e=>{e&&t()})}}},D=f,m=(a("f0c1"),a("2877")),b=Object(m["a"])(D,l,n,!1,null,"48853838",null),v=b.exports,y={components:{ProList:s["ProList"],ProLayout:s["ProLayout"],ProDrawer:s["ProDrawer"],ProDialog:s["ProDialog"],IconSvg:s["IconSvg"],TagDetailForm:v},data(){return{statusList:[{label:"开启",value:0},{label:"关闭",value:1}],deptData:[],addDate:[],multipleSelection:[],loading:!1,tableData:[],queryParams:{},pageParams:{pageNum:1,pageSize:10},queryDeptData:[],total:0,drawerVisible:!1,tagDetailMode:"add",tagDetail:{},dialogVisible:!1}},mounted(){this.getDeptDictionaryForQuery(),this.onInquire()},methods:{async getDeptDictionaryForQuery(){try{const t=await g(),e=t.result;this.filterDeptData(e),this.queryDeptData=e}catch(t){}},filterDeptData(t){t.forEach(t=>{t.children.length?this.filterDeptData(t.children):t.children=null})},handleSelectionChange(t){this.multipleSelection=t},async onInquire(){try{const t=await c({...this.queryParams,createDateS:this.addDate&&this.addDate[0]?this.addDate[0]+" 00:00:00":"",createDateE:this.addDate&&this.addDate[1]?this.addDate[1]+" 23:59:59":"",deptId:this.queryParams.deptId?this.queryParams.deptId[this.queryParams.deptId.length-1]:"",...this.pageParams});this.tableData=t.result.records,this.tableData.forEach(t=>{for(let e in t)""===t[e]&&(t[e]="/")}),this.total=t.result.total}catch(t){}},showTagDetail(t,e){this.tagDetailMode=t,"add"===t?(this.tagDetail={status:0},this.drawerVisible=!0):(this.tagDetail={status:0,tagShowDesc:e.tagShowDesc,tagDesc:e.tagDesc,description:e.description,deptId:e.deptIds,ids:e.ids},this.dialogVisible=!0)},handleDelete(){},handleDetail(t){this.$router.push({name:"ActivityAdd",query:{status:"etails",activityId:t.id,activityPro:t.statusDesc}})},batchStart(){const t={ids:this.multipleSelection.map(t=>t.ids).reduce((t,e)=>t.concat(e)),status:0};this.changeStatus(t,"batchStart"),this.clearFun()},resetQueryParams(){this.queryParams={},this.pageParams={pageSize:10,pageNum:1},this.addDate=[],this.onInquire()},clearFun(){this.$refs.singleTable.clearSelection()},handleSubmitTagDetail(t){this.$refs[t].validate(async()=>{try{let e="",a="",r={...this.tagDetail,deptId:this.tagDetail.deptId[this.tagDetail.deptId.length-1]};"drawerTagDetail"===t?(a="标签新增成功",e="drawerVisible"):(e="dialogVisible",a="标签修改成功");const i=await d(r);0===i.code?(this.$message.success(a),this[e]=!1,this.queryParams={},this.pageParams={pageSize:10,pageNum:1},this.getDeptDictionaryForQuery()):this.$message.error(i.data.desc),this.onInquire()}catch(e){}})},async handleSwitchChange(t){const e={ids:t.ids,status:0===t.status?1:0};if(0===t.status){const a=await this.checkTagUseStatus(t);a?this.$confirm("该标签已有客户使用，停用后新客户将无法使用！确认停用吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.changeStatus(e)}).catch(()=>{}):this.changeStatus(e)}else this.changeStatus(e)},async checkTagUseStatus(t){try{const e=await p({ids:t.ids});return e.result}catch(e){}},async changeStatus(t,e){try{await h(t);"batchStart"===e?this.$message.success(`成功开启${t.ids.length}条`):this.$message.success("操作成功"),this.onInquire()}catch(a){}}}},w=y,k=(a("4e26"),Object(m["a"])(w,r,i,!1,null,"3329240e",null));e["default"]=k.exports},f0c1:function(t,e,a){"use strict";a("bd58")}}]);